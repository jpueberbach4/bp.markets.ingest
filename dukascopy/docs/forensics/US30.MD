# FORENSICS US30

## Prices PRE-2019-12-27

```sh
US:

2019.12.26	16:00:00	28538.57	28595.67	28527.07	28569.67	4.17852
2019.12.26	20:00:00	28569.67	28635.67	28551.17	28631.67	2.91559
2019.12.27	00:00:00	28612.97	28669.47	28607.47	28667.97	1.56073
2019.12.27	04:00:00	28668.47	28690.47	28664.47	28678.47	1.0294
2019.12.27	08:00:00	28677.97	28715.07	28671.47	28693.81	2.674225
2019.12.27	12:00:00	28693.81	28731.88	28691.89	28693.9	1.34359
2019.12.27	16:00:00	28693.9	28704.1	28616.0	28683.49	2.275188

MT4

2019.12.26	16:00	285385.70	285956.70	285280.70	285696.70	12798
2019.12.26	20:00	285701.70	286356.70	285511.70	286316.70	8833
2019.12.27	00:00	286119.70	286694.70	286074.70	286674.70	4799
2019.12.27	04:00	286669.70	286904.70	286644.70	286794.70	3141
2019.12.27	08:00	286789.70	287150.70	286714.70	286938.10	8368
2019.12.27	12:00	28693.81	28731.88	28691.89	28693.90	6422 < SWITCH POINT
2019.12.27	16:00	28693.90	28704.10	28616.48	28664.45	8168

NOTICE: Factor 10 on MT4, raw 1m data contains correct values.
``` 

## Proposed configuration for maximum MT4 alignment:

How to do this stuff? Export data from MT4. Install beyond compare.

Remove all assets from the symbols.user.txt, except the one you want to configure.

Dump data for H4 with ```./build-csv.sh --select USA30.IDX-USD/4h --output us30.csv --mt4```

Drag us30_*.csv to left side of the screen, drag the MT4 export to right side of screen, in Beyond compare.

Start scrolling from bottom, upwards, look at the open prices but more importantly, the timestamps.

For every block that changes, you can do something like the example below.

Gladly, the underlying DST/STD shifts at the MT4-end are in order for this asset - no ASX-alike weirdness.

When you have made some changes, ```./rebuild-resample.sh```, reload file in beyond compare. Repeat.

All done? restore your symbols.user.txt and execute ```./rebuild-resample.sh``` once more.

**How much time does this take?**

Constructing the config below took me about 45 minutes. So 45 minutes to get 7 years of data in order with Dukascopy MT4.
After a few implementations, you will notice it is very much copy-paste and just adjusting from and to dates. There are two main blocks in the config file. Block A and Block B.

```yaml
USA30.IDX-USD:
  timezone: America/New_York
  sessions:
    # This is an extreme example on how to get 7 years of data aligned. 
    # Use it for reference and extend this one to get a grasp of the concept.
    # This is a very obsessive configuration. Every shift, even if a only a week is
    # misaligned, is handled. 
    ancient-2018-03:
      # Block A
      to_date: "2018-03-11 00:00:00"
      ranges:
        24h:
          from: "00:00"
          to: "23:59"
      timeframes:
        4h:
          origin: "epoch" 
    2018-03-2018-03:
      # Block B
      from_date: "2018-03-11 20:00:00"
      to_date: "2018-03-25 00:00:00"
      ranges:
        24h:
          from: "00:00"
          to: "23:59"
      timeframes:
        4h:
          origin: "03:00"     
    2018-03-2018-10:
      # Block A
      from_date: "2018-03-25 00:00:00"
      to_date: "2018-10-25 00:00:00"
      ranges:
        24h:
          from: "00:00"
          to: "23:59"
      timeframes:
        4h:
          origin: "epoch" 
    2018-10-2018-11:
      # Block B
      from_date: "2018-10-27 00:00:00"
      to_date: "2018-11-04 00:00:00"
      ranges:
        24h:
          from: "00:00"
          to: "23:59"
      timeframes:
        4h:
          origin: "03:00" 
    2018-11-2019-03:
      # Block A
      from_date: "2018.11.04 00:00:00"
      to_date: "2019-03-09 00:00:00"
      ranges:
        24h:
          from: "00:00"
          to: "23:59"
      timeframes:
        4h:
          origin: "epoch"  
    2019-03-2019-03:
      # Block B
      from_date: "2019-03-09 00:00:00"
      to_date: "2019-03-30 00:00:00"
      ranges:
        24h:
          from: "00:00"
          to: "23:59"
      timeframes:
        4h:
          origin: "03:00" 
    2019-03-2019-10:
      # Block A
      from_date: "2019-03-30 00:00:00"
      to_date: "2019-10-26 00:00:00"
      ranges:
        24h:
          from: "00:00"
          to: "23:59"
      timeframes:
        4h:
          origin: "epoch"      
    2019-10-2019-11:
      # Block B
      from_date: "2019-10-26 00:00:00"
      to_date: "2019-11-03 00:00:00"
      ranges:
        24h:
          from: "00:00"
          to: "23:59"
      timeframes:
        4h:
          origin: "03:00"    
    2019-11-2020-02:
      # Final Block A (with a ghost candle cleanup since shift happens during the day)
      from_date: "2019-11-03 00:00:00"
      to_date: "2020-02-06 13:00:00"
      ranges:
        open:
          from: "00:00"
          to: "23:59"
      timeframes:
        4h:
          origin: "epoch"
          post:
            merge-step:
              action: merge
              ends_with:
              - "2020-02-06 20:00:00"
              offset: -1
    # Only from here, we start acting "normal"
    2020-02-now:
      # Block C
      from_date: "2020-02-06 13:01"
      ranges:
        open:
          from: "00:00"
          to: "23:59"
      timeframes:
        4h:
          origin: "01:00"
```

## More examples

I will be posting more examples, in-time. 